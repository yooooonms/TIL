# ì¡°ì¸ í…Œì´ë¸”  

ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”ì˜ ì—°ê´€ê´€ê³„ë¥¼ ì„¤ê³„í•˜ëŠ” ë°©ë²•ì€ í¬ê²Œ 2ê°€ì§€ê°€ ìˆë‹¤.  

- ì¡°ì¸ ì»¬ëŸ¼ ì‚¬ìš© (ì™¸ë˜ í‚¤)
- ì¡°ì¸ í…Œì´ë¸” ì‚¬ìš© (í…Œì´ë¸” ì‚¬ìš©)

## ì¡°ì¸ ì»¬ëŸ¼ ì‚¬ìš©  

í…Œì´ë¸” ê°„ì— ê´€ê³„ëŠ” ì£¼ë¡œ ì¡°ì¸ ì»¬ëŸ¼ì´ë¼ ë¶€ë¥´ëŠ” ì™¸ë˜ í‚¤ ì»¬ëŸ¼ì„ ì‚¬ìš©í•´ ê´€ë¦¬í•œë‹¤.  

```text
MEMBER TABLE
+-------------+------------+-------------+
| MEMBER_ID   | USERNAME   | LOCKER_ID   |
+-------------+------------+-------------+
| M_ID1       | MEMBER1    | null        |
+-------------+------------+-------------+
| M_ID2       | MEMBER2    | null        |
+-------------+------------+-------------+
| M_ID3       | MEMBER3    | L_ID1       |
+-------------+------------+-------------+

LOCKER TABLE
+-------------+------------+
| LOCKER_ID   | NAME       |
+-------------+------------+
| L_ID1       | LOCKER1    |
+-------------+------------+
```

íšŒì›ì´ ì‚¬ë¬¼í•¨ì„ ì‚¬ìš©í•˜ê¸° ì „ê¹Œì§€ëŠ” ì•„ì§ ë‘˜ ì‚¬ì´ì— ê´€ê³„ê°€ ì—†ê¸° ë•Œë¬¸ì— MEMBER í…Œì´ë¸”ì˜ LOCKER_ID ì™¸ë˜ í‚¤ì— nullì„ ì…ë ¥í•´ì•¼ í•œë‹¤. ì™¸ë˜ í‚¤ì— nullì„ í—ˆìš©í•˜ëŠ” ê´€ê³„ë¥¼ ì„ íƒì  ë¹„ì‹ë³„ ê´€ê³„ë¼ê³  í•œë‹¤.  

ì„ íƒì  ë¹„ì‹ë³„ ê´€ê³„ëŠ” ì™¸ë˜ í‚¤ì— nullì„ í—ˆìš©í•˜ê¸° ë•Œë¬¸ì— íšŒì›ê³¼ ì‚¬ë¬¼í•¨ì„ ì¡°ì¸í•  ë•ŒëŠ” ì™¸ë¶€ ì¡°ì¸ì„ ì‚¬ìš©í•´ì•¼ í•œë‹¤.  

ë‚´ë¶€ ì¡°ì¸ì„ ì‚¬ìš©í•˜ë©´ ì‚¬ë¬¼í•¨ê³¼ ê´€ê³„ê°€ ì—†ëŠ” íšŒì›ì€ ì¡°íšŒë˜ì§€ ì•ŠëŠ”ë‹¤.  

íšŒì›ê³¼ ì‚¬ë¬¼í•¨ì´ ì•„ì£¼ ê°€ë” ê´€ê³„ë¥¼ ë§ºëŠ”ë‹¤ë©´ ì™¸ë˜ í‚¤ ê°’ ëŒ€ë¶€ë¶„ì´ nullë¡œ ì €ì¥ë˜ëŠ” ë‹¨ì ì´ ìˆë‹¤.  

## ì¡°ì¸ í…Œì´ë¸” ì‚¬ìš©  


```text
MEMBER TABLE
+-------------+------------+
| MEMBER_ID   | USERNAME   |
+-------------+------------+
| M_ID1       | MEMBER1    |
+-------------+------------+
| M_ID2       | MEMBER2    |
+-------------+------------+
| M_ID3       | MEMBER3    |
+-------------+------------+

MEMBER_LOCKER_TABLE
+-------------+------------+
| MEMBER_ID   | LOCKER_ID  |
+-------------+------------+
| M_ID3       | L_ID1      |
+-------------+------------+

LOCKER TABLE
+-------------+------------+
| LOCKER_ID   | NAME       |
+-------------+------------+
| L_ID1       | LOCKER1    |
+-------------+------------+
```

ì¡°ì¸ í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì€ ì—°ê´€ê´€ê³„ë¥¼ ê´€ë¦¬í•˜ëŠ” ì¡°ì¸ í…Œì´ë¸”ì„ ì¶”ê°€í•˜ê³  ë‘ í…Œì´ë¸”ì˜ ì™¸ë˜ í‚¤ë¥¼ ê°€ì§€ê³  ì—°ê´€ê´€ê³„ë¥¼ ê´€ë¦¬í•˜ëŠ” ë°©ë²•ì´ë‹¤.  

ê·¸ë ‡ê¸° ë•Œë¬¸ì— MEMBER, LOCKER í…Œì´ë¸”ì—ëŠ” ì—°ê´€ê´€ê³„ë¥¼ ê´€ë¦¬í•˜ê¸° ìœ„í•œ ì™¸ë˜ í‚¤ ì»¬ëŸ¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤.  

í…Œì´ë¸”ì„ í•˜ë‚˜ ì¶”ê°€í•´ì•¼í•˜ê¸° ë•Œë¬¸ì— ê´€ë¦¬í•´ì•¼ í•˜ëŠ” í…Œì´ë¸”ì´ ëŠ˜ì–´ë‚˜ê³  ë‘ í…Œì´ë¸”ì„ ì¡°ì¸í•˜ê¸° ìœ„í•´ì„œëŠ” MEMBER_LOCKER í…Œì´ë¸”ê¹Œì§€ ì¶”ê°€ë¡œ ì¡°ì¸í•´ì•¼ í•œë‹¤.  

ê¸°ë³¸ìœ¼ë¡œ ì¡°ì¸ ì»¬ëŸ¼ì„ ì‚¬ìš©í•˜ê³  ì¡°ì¸ í…Œì´ë¸”ì€ í•„ìš”í•˜ë‹¤ê³  íŒë‹¨ë  ë•Œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.  

- ê°ì²´ì™€ í…Œì´ë¸”ì„ ë§¤í•‘í•  ë•Œ ì¡°ì¸ ì»¬ëŸ¼ì€ @JoinColumnìœ¼ë¡œ ë§¤í•‘í•˜ê³  ì¡°ì¸ í…Œì´ë¸”ì€ @JoinTableë¡œ ë§¤í•‘í•œë‹¤.
- ì¡°ì¸ í…Œì´ë¸”ì€ ì£¼ë¡œ ë‹¤ëŒ€ë‹¤ ê´€ê³„ë¥¼ ì¼ëŒ€ë‹¤, ë‹¤ëŒ€ì¼ ê´€ê³„ë¡œ í’€ì–´ë‚´ê¸° ìœ„í•´ ì‚¬ìš©í•œë‹¤.
- í•˜ì§€ë§Œ ì¼ëŒ€ì¼, ì¼ëŒ€ë‹¤, ë‹¤ëŒ€ì¼ ê´€ê³„ì—ì„œë„ ì‚¬ìš©í•œë‹¤.

## ì¼ëŒ€ì¼ ì¡°ì¸ í…Œì´ë¸”  

<img src="/Jpa/image/onetoone.png" width="550" height="300">  

ì¼ëŒ€ì¼ ê´€ê³„ë¥¼ ë§Œë“¤ê¸° ìœ„í•´ì„œëŠ” ì¡°ì¸ í…Œì´ë¸”ì˜ ì™¸ë˜ í‚¤ ì»¬ëŸ¼ì— ê°ê° 2ê°œì˜ ìœ ë‹ˆí¬ ì œì•½ì¡°ê±´ì„ ê±¸ì–´ì•¼í•œë‹¤.  

```java
@Entity
public class Parent {
    @Id @GeneratedValue
    @Column(name = "parent_id")
    private Long id;

    private String name;

    @OneToOne
    @JoinTable(name = "PARENT_CHILD",
        joinColumns = @JoinColumn(name = "parent_id"),
        inverseJoinColumns = @JoinColumn(name = "child_id")
    )
    private Child child;

    ...
}

@Entity
public class Child {
    @Id @GeneratedValue
    @Column(name = "child_id")
    private Long id;

    private String name;

    ...
}
```

@JoinTableì˜ ì†ì„±  

- name: ë§¤í•‘í•  ì¡°ì¸ í…Œì´ë¸” ì´ë¦„
- joinColumns: í˜„ì¬ ì—”í‹°í‹°ë¥¼ ì°¸ì¡°í•˜ëŠ” ì™¸ë˜ í‚¤
- inverseJoinColumns: ë°˜ëŒ€ë°©í–¥ ì—”í‹°í‹°ë¥¼ ì°¸ì¡°í•˜ëŠ” ì™¸ë˜ í‚¤

ì–‘ë°©í–¥ìœ¼ë¡œ ë§¤í•‘í•˜ê¸° ìœ„í•´ì„œëŠ” ë‹¤ìŒ ì½”ë“œë¥¼ ì¶”ê°€í•˜ë¨¼ ëœë‹¤.  

```java
@OneToOne(mappedBy = "child")
private Parent parent;
```

## ì¼ëŒ€ë‹¤ ì¡°ì¸ í…Œì´ë¸”  

<img src="/Jpa/image/onetomany.png" width="550" height="300">  

```java
@Entity
public class Parent {
    @Id @GeneratedValue
    @Column(name = "parent_id")
    private Long id;

    private String name;

    @OneToMany
    @JoinTable(name = "PARENT_CHILD",
        joinColumns = @JoinColumn(name = "parent_id"),
        inverseJoinColumns = @JoinColumn(name = "child_id")
    )
    private List<Child> childs = new ArrayList<>();

    ...
}

@Entity
public class Child {
    @Id @GeneratedValue
    @Column(name = "child_id")
    private Long id;

    private String name;

    ...
}
```

## ë‹¤ëŒ€ì¼ ì¡°ì¸ í…Œì´ë¸”  

ë‹¤ëŒ€ì¼ì€ ì¼ëŒ€ë‹¤ì—ì„œ ë°©í–¥ë§Œ ë°˜ëŒ€ì´ê¸° ë•Œë¬¸ì— ì¡°ì¸ í…Œì´ë¸” ëª¨ì–‘ì€ ì¼ëŒ€ë‹¤ì™€ ê°™ë‹¤.  

```java
@Entity
public class Parent {
    @Id @GeneratedValue
    @Column(name = "parent_id")
    private Long id;

    private String name;

    @OneToMany(mappedBy = "parent")
    private List<Child> childs = new ArrayList<>();

    ...
}

@Entity
public class Child {
    @Id @GeneratedValue
    @Column(name = "child_id")
    private Long id;

    private String name;

    @ManyToOne(optional = false)
    @JoinTable(name = "PARNET_CHILD",
        joinColumns = @JoinColumn(name = "child_id"),
        inverseJoinColumns = @JoinColumn(name = "parent_id")
    )
    private Parent parent;

    ...
}
```

## ë‹¤ëŒ€ë‹¤ ì¡°ì¸ í…Œì´ë¸”  

ë‹¤ëŒ€ë‹¤ ê´€ê³„ë¥¼ ë§Œë“¤ë ¤ë©´ ì¡°ì¸ í…Œì´ë¸”ì˜ ë‘ ì»¬ëŸ¼ì„ í•©í•´ì„œ í•˜ë‚˜ì˜ ë³µí•© ìœ ë‹ˆí¬ ì œì•½ì¡°ê±´ì„ ê±¸ì–´ì•¼í•œë‹¤.  

<img src="/Jpa/image/manytomany.png" width="550" height="150">  

```java
@Entity
public class Parent {
    @Id @GeneratedValue
    @Column(name = "parent_id")
    private Long id;

    private String name;

    @ManyToMany
    @JoinTable(name = "PARENT_CHILD",
        joinColumns = @JoinColumn(name = "parent_id"),
        inverseJoinColumns = @JoinColumn(name = "child_id")
    )
    private List<Child> childs = new ArrayList<>();

    ...
}

@Entity
public class Child {
    @Id @GeneratedValue
    @Column(name = "child_id")
    private Long id;

    private String name;

    ...
}
```

## ì—”í‹°í‹° í•˜ë‚˜ì— ì—¬ëŸ¬ í…Œì´ë¸” ë§¤í•‘  

ì˜ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ê¸°ëŠ¥ì´ì§€ë§Œ @SecondaryTable ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ë©´ í•œ ì—”í‹°í‹°ì— ì—¬ëŸ¬ í…Œì´ë¸”ì„ ë§¤í•‘í•  ìˆ˜ ìˆë‹¤.  

<img src="/Jpa/image/secondary.png" width="450" height="300">

```java
@Entity
@SecondaryTable(name = "BOARD_DETAIL",
    pkJoinColumns = @PrimaryKeyJoinColumn(name = "BOARD_DETAIL_ID"))
public class Board {
    @Id @GeneratedValue
    @Column(name = "board_id")
    private Long id;

    private String title;

    @Column(table = "BOARD_DETAIL")
    private String content;

    ...
}
```

- @SecondaryTable.name: ë§¤í•‘í•  ë‹¤ë¥¸ í…Œì´ë¸” ì´ë¦„
- @SecondaryTable.pkJoinColumns: ë§¤í•‘í•  ë‹¤ë¥¸ í…Œì´ë¸”ì˜ ê¸°ë³¸ í‚¤ ì»¬ëŸ¼ ì†ì„±

```java
@Column(table = "BOARD_DETAIL")
private String content;
```

content í•„ë“œëŠ” @Column(table = "BOARD_DETAIL")ì„ ì‚¬ìš©í•´ì„œ BOARD_DETAIL í…Œì´ë¸”ì˜ ì»¬ëŸ¼ì— ë§¤í•‘í–ˆë‹¤.  

title í•„ë“œ ì²˜ëŸ¼ í…Œì´ë¸”ì„ ì§€ì •í•˜ì§€ ì•Šìœ¼ë©´ ê¸°ë³¸ í…Œì´ë¸”ì¸ BOARDì— ë§¤í•‘ëœë‹¤.  

ë” ë§ì€ í…Œì´ë¸”ì„ ë§¤í•‘í•˜ë ¤ë©´ @SecondaryTablesë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤.  

---

#### ğŸ“Œ Reference  

- ìë°” ORM í‘œì¤€ JPA í”„ë¡œê·¸ë˜ë° | ê¹€ì˜í•œ ì €