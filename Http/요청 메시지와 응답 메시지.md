# HTTP 메시지 구조  

클라이언트가 서버에게 보낸 HTTP 메시지를 **요청 메시지**라 부르며, 서버가 클라이언트에게 보낸 HTTP 메시지를 **응답 메시지**라고 부른다.  

HTTP 메시지는 ASCII로 인코딩된 텍스트 정보이며 여러 줄로 되어있다.  

HTTP 요청 메시지와 응답 메시지의 구조는 서로 비슷하며 구조는 다음과 같다.  

1. 시작 줄 (start-line)에는 실행되어야 할 요청 또는 요청 수행에 대한 성공 또는 실패가 기록되어 있다. 시작 줄은 항상 한 줄로 끝난다.
2. 옵션으로 HTTP 헤더 세트가 들어간다. 여기에는 요청에 대한 설명 혹은 메시지 본문에 대한 설명이 들어간다.
3. 요청에 모든 메타 정보가 전송되었음을 알리는 빈 줄(blank line)이 삽입된다.
4. 요청과 관련된 내용이 옵션으로 들어가거나 응답과 관련된 문서가 들어간다. 본문의 존재유무 및 크기는 첫 줄과 HTTP 헤더에 명시된다.

HTTP 요청 메시지의 시작 줄과 HTTP 헤더를 묶어서 요청 헤드(head)라고 부르며 HTTP 메시지의 페이로드는 본문(body)라고 한다.  

본문은 HTTP 메시지가 가지고 있는 실제 구체적인 내용으로 모든 요청과 응답에 대해서 본문이 포함되는 것은 아니다.  

본문은 Text, Json 뿐만 아니라 이미지, 비디오, HTML 등 다양한 형식이 들어올 수 있다.  

<img src="/Http/image/message.png" width="900" height="300">  

## HTTP 요청  

#### - 시작 줄 (start line)  

시작 줄은 다음과 같이 세 가지 요소로 이루어져 있다.  

1. HTTP 메소드로 영어 GET, POST 등을 사용해 서버가 수행해야할 동작을 나타낸다.
2. 요청 타겟으로 주로 URL 또는 프로토콜, 포트, 도메인의 절대 경로로 나타낼 수 있다.
3. HTTP 버전이 들어간다. 응답 메시지에서 써야할 HTTP 버전을 알려주는 역할을 한다.

```text
GET /hello HTTP/1.1
```

#### - 헤더 (header)  

대소문자 구분없는 문자열 다음에 `콜론(:)`이 붙으며 그 뒤에 오는 값은 헤더에 따라 달라진다.  

헤더는 값까지 포함해 한 줄로 구성되기 때문에 꽤 길어질 수 있다.  

<img src="/Http/image/request-header.png" width="800" height="300">  

- **General Header:** 메시지 전체에 적용된다.
- **Request Header:** 헤더의 내용을 좀 더 구체화 시키고, 컨텍스트를 제공하기도 하며, 조건에 따른 제약 사항을 가하기도 하면서 요청 내용을 수정한다.
- **Entity Header:** 요청 본문에 적용되며 요청 내에 본문이 없는 경우 Entity Header는 전송되지 않는다.

#### - 본문 (body)  

요청의 마지막 부분에 들어가며 모든 요청에 본문이 들어가지는 않는다.  

`GET, HEAD, DELETE, OPTIONS` 처럼 리소스를 가져오는 요청은 보통 본문이 필요없다.  

일부 요청은 업데이트를 하기 위해 서버에 데이터를 보내는데 보통 `POST, PUT` 요청일 경우가 있다.  

## HTTP 응답  

#### - 상태 줄 (status line)  

HTTP 응답의 시작 줄은 상태 줄(status line)이라고 부르며 다음과 같은 정보를 가지고 있다.  

1. 프로토콜 버전: 대부분 `HTTP/1.1`을 사용한다.
2. 요청의 성공 여부를 나타내는 상태코드 200, 400, 404 등이 있다.
3. 짧고 간결하게 상태 코드에 대한 설명을 글로 나타낸다.

```text
HTTP/1.1 200 OK
```

#### - 헤더 (header)  

대소문자 구분없는 문자열 다음에 `콜론(:)`이 붙으며 그 뒤에 오는 값은 헤더에 따라 달라진다.  

헤더는 값까지 포함해 한 줄로 구성되기 때문에 꽤 길어질 수 있다.  

<img src="/Http/image/response-header.png" width="800" height="300">  

- **General Header:** 메시지 전체에 적용된다.
- **Response Header:** 상태 줄에 미쳐 들어가지 못했던 서버에 대한 추가 정보를 제공한다.
- **Entity Header:** 요청 본문에 적용되며 요청 내에 본문이 없는 경우 Entity Header는 전송되지 않는다.

#### - 본문 (body)  

요청과 마찬가지로 마지막 부분에 들어가며 모든 응답에 본문이 포함되는 것은 아니다.  

201, 204 상태 코드를 가진 응답은 보통 본문이 없다.  

---

#### 📌 Reference  

- <https://developer.mozilla.org/ko/docs/Web/HTTP/Messages>