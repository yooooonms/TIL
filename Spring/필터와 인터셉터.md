μ• ν”λ¦¬μΌ€μ΄μ…μ„ κ°λ°ν•λ‹¤λ³΄λ©΄ κ³µν†µμΌλ΅ μ²λ¦¬ν•΄μ•Ό ν•  μ‘μ—…λ“¤μ΄ λμ–΄λ‚λ‹¤.  

κ³µν†µμΌλ΅ μ²λ¦¬ν•΄μ•Όν•  λ΅μ§λ“¤μ„ λ¨λ“  ν΄λμ¤λ§λ‹¤ μ‘μ„±ν•΄μ•Ό ν•λ‹¤λ©΄ μ¤‘λ³µλλ” μ½”λ“κ°€ λμ–΄λ‚ μ μ§€λ³΄μκ°€ μ–΄λ µλ‹¤.  

κ³µν†µλ΅μ§μ€ ν•κ³³μ— λ¨μ•„μ„ κ΄€λ¦¬ν•λ” κ²ƒμ΄ λ³΄κΈ°λ„ μΆ‹κ³  μ μ§€λ³΄μκ°€ λ›°μ–΄λ‚λ‹¤.  

κ³µν†µλ΅μ§μ„ μ²λ¦¬ν•κΈ° μ„ν•΄ λ‹¤μ 3κ°€μ§€ κΈ°λ¥μ„ μ κ³µν•λ‹¤.  

- Filter
- Interceptor
- AOP

Filter, Interceptor, AOPλ” λ™μ‘μ„ ν•κΈ° μ „μ— λ¨Όμ € μ‹¤ν–‰ν•κ±°λ‚ μ‹¤ν–‰ ν›„μ— μ¶”κ°€μ μΈ λ™μ‘μ΄ ν•„μ”ν•  λ• μ‚¬μ©λλ” κΈ°λ¥μ΄λ‹¤.  

## ν•„ν„°, μΈν„°μ…‰ν„°, AOP μ‹¤ν–‰ νλ¦„  

<img src="/Spring/image/flow.png" witdh="600" height="300">  

ν΄λΌμ΄μ–ΈνΈμ μ”μ²­μ΄ λ“¤μ–΄μ¤λ©΄ λ‹¤μκ³Ό κ°™μ€ μμ„λ΅ λ™μ‘ν•κ³  μ‘λ‹µν•λ‹¤.  

```text
request β†’ Filter β†’ Interceptor β†’ AOP β†’ Interceptor β†’ Filter β†’ response
```

## Filter  

ν•„ν„°λ” ν΄λΌμ΄μ–ΈνΈμ μ”μ²­κ³Ό μ‘λ‹µμ΄ DipatcherServletμ— λ„λ‹¬ν•κΈ° μ „ν›„λ΅ κ³µν†µμΌλ΅ μ²λ¦¬ν•  μ‘μ—…μ— μ‚¬μ©λλ‹¤.  

μΈμ½”λ”© μ²λ¦¬, CORS, HTTP ν—¤λ” λ“±μ„ μΌκ΄„μ μΌλ΅ μ„¤μ •ν•  μ μλ‹¤.  

Filterλ¥Ό μ¶”κ°€ν•κΈ° μ„ν•΄μ„λ” `javax.servlet.Filter` μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν•λ©΄ λλ‹¤.  

```java
public interface Filter {

    public default void init(FilterConfig filterConfig) throws ServletException {}

    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException;

    public default void destroy() {}

}
```

#### - init  

ν•„ν„° κ°μ²΄λ¥Ό μ΄κΈ°ν™”ν•κ³  μ„λΉ„μ¤μ— μ¶”κ°€ν•κΈ° μ„ν• λ©”μ†λ“μ΄λ‹¤.  

μ›Ή μ»¨ν…μ΄λ„κ°€ 1ν init λ©”μ†λ“λ¥Ό νΈμ¶ν•μ—¬ ν•„ν„° κ°μ²΄λ¥Ό μ΄κΈ°ν™”ν•κ³ , μ΄ν›„μ μ”μ²­λ“¤μ€ doFilter λ©”μ†λ“λ¥Ό ν†µν•΄ μ „ν›„λ΅ μ²λ¦¬λλ‹¤.  

#### - doFilter  

ν΄λΌμ΄μ–ΈνΈμ λ¨λ“  HTTP μ”μ²­μ΄ DispatcherServletμΌλ΅ μ „λ‹¬λκΈ° μ „ν›„μ— μ›Ή μ»¨ν…μ΄λ„μ— μν•΄ μ‹¤ν–‰λλ” λ©”μ†λ“μ΄λ‹¤.  

doFilter λ©”μ†λ“μ `FilterChain` νλΌλ―Έν„°μ chain.doFilter(request, response)λ¥Ό κΈ°μ μΌλ΅ μ „ν›„ μ²λ¦¬κ°€λ¥ν•λ‹¤.  

#### - destroy  

ν•„ν„° κ°μ²΄λ¥Ό μ„λΉ„μ¤μ—μ„ μ κ±°ν•κ³  μ‚¬μ©ν•λ” μμ›μ„ λ°ν™ν™”κΈ° μ„ν• λ©”μ†λ“μ΄λ‹¤.  

μ›Ή μ»¨ν…μ΄λ„μ— μν•΄ 1λ² νΈμ¶λλ©° destroyκ°€ νΈμ¶λ μ΄ν›„ μ”μ²­μ€ doFilterμ— μν•΄ μ²λ¦¬λμ§€ μ•λ”λ‹¤.  

## Interceptor  

ν•„ν„°λ” μ¤ν”„λ§ μ»¨ν…μ¤νΈ μ™Έλ¶€μ— μ΅΄μ¬ν•΄ μ¤ν”„λ§κ³Ό λ¬΄κ΄€ν• μμ›μ— λ€ν•΄ λ™μ‘ν•λ‹¤λ” μ μ΄ μλ‹¤.  

ν•μ§€λ§ μΈν„°μ…‰ν„°λ” μ¤ν”„λ§μ΄ μ κ³µν•λ” κΈ°λ¥μΌλ΅ DispathcerServletμ΄ μ»¨νΈλ΅¤λ¬λ¥Ό νΈμ¶ν•κΈ° μ „ν›„λ΅ λΌμ–΄λ“¤μ–΄ μ”μ²­κ³Ό μ‘λ‹µμ— λ€ν•΄ μ²λ¦¬ν•λ‹¤.  

μ¤ν”„λ§ μ»¨ν…μ¤νΈ λ‚΄λ¶€μ— μ΅΄μ¬ν•κΈ° λ•λ¬Έμ— **μ¤ν”„λ§μ λ¨λ“  λΉ κ°μ²΄μ— μ ‘κ·Όν•  μ μλ‹¤.**  

DispathcerServletμ€ ν•Έλ“¤λ¬ λ§¤ν•‘μ„ ν†µν•΄ μ μ ν• μ»¨νΈλ΅¤λ¬λ¥Ό μ°Ύλ„λ΅ μ”μ²­ν•λ”λ° κ²°κ³Όλ΅ HandlerExecutionChainμ„ λ°ν™ν•λ‹¤.  

HandlerExecutionChainλ” 1κ° μ΄μƒμ μΈν„°μ…‰ν„°κ°€ λ“±λ΅λμ–΄ μλ‹¤λ©΄ μμ°¨μ μΌλ΅ μΈν„°μ…‰ν„°λ“¤μ„ κ±°μ³ μ»¨νΈλ΅¤λ¬κ°€ μ‹¤ν–‰λλ„λ΅ ν•κ³  μ—†λ‹¤λ©΄ λ°”λ΅ μ»¨νΈλ΅¤λ¬λ¥Ό μ‹¤ν–‰ν•λ‹¤.  

μΈν„°μ…‰ν„°λ” μ—¬λ¬ κ°λ¥Ό μ‚¬μ©ν•  μ μμΌλ©° λ΅κ·ΈμΈ κ²€μ‚¬, κ¶ν• κ²€μ‚¬ λ“±μ μ—…λ¬΄λ¥Ό μ²λ¦¬ν•λ‹¤.  

μΈν„°μ…‰ν„°λ¥Ό μ¶”κ°€ν•κΈ° μ„ν•΄μ„λ” `org.springframework.web.servlet.HandlerInterceptor` μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν•λ©΄ λλ‹¤.  

```java
public interface HandlerInterceptor {

    default boolean preHandler(HttpServletRequest request, HttpServietResponse response, Object handler) throws Exception {
        return true;
    }

    default void postHandler(HttpServletRequest request, HttpServletResponse response, Object handler, @Nullable ModelAndView modelAndView) throws Exception {}

    default void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, @Nullable Exception ex) throws Exception {}

}
```

#### - preHandler  

μ»¨νΈλ΅¤λ¬κ°€ νΈμ¶λκΈ° μ „μ— μ‹¤ν–‰λλ” λ©”μ†λ“  

preHandlerμ λ°ν™ νƒ€μ…μ€ boolean νƒ€μ…μΌλ΅ λ°ν™ κ°’μ΄ trueμ΄λ©΄ λ‹¤μ λ‹¨κ³„λ΅ μ§„ν–‰λμ§€λ§ falseλ©΄ μ‘μ—…μ„ μ¤‘λ‹¨ν•κ³  μ΄ν›„μ μ‘μ—…(μ»¨νΈλ΅¤λ¬, μΈν„°μ…‰ν„°)μ€ μ§„ν–‰λμ§€ μ•λ”λ‹¤.  

#### - postHandler  

μ»¨νΈλ΅¤λ¬κ°€ νΈμ¶λ ν›„μ— μ‹¤ν–‰λλ” λ©”μ†λ“  

ModelAndViewλ¥Ό μ κ³µν•λ”λ° μ΄λ¥Ό ν†µν•΄ view Modelμ„ μ΅°μ‘ν•  μ μλ‹¤.  

#### - afterCompletion  

λ·°μ—μ„ μµμΆ… κ²°κ³Όλ¥Ό μƒμ„±ν•λ” μΌμ„ ν¬ν•¨ν•κ³  λ¨λ“  μ‘μ—…μ„ λ§μΉ λ’¤μ— μ‹¤ν–‰λλ” λ©”μ†λ“  

## AOP  

μΈν„°μ…‰ν„°μ™€ ν•„ν„°μ™€λ” λ‹¤λ¥΄κ² λ©”μ†λ“ μ „ν›„λ΅ μμ λ΅­κ² μ„¤μ •μ΄ κ°€λ¥ν•λ‹¤.  

μΈν„°μ…‰ν„°μ™€ ν•„ν„°λ” μ”μ²­ URIλ΅ λ€μƒμ„ κµ¬λ¶„ν•λ” λ°λ©΄ AOPλ” URI, νλΌλ―Έν„°, μ–΄λ…Έν…μ΄μ… λ“± λ‹¤μ–‘ν• λ°©λ²•μ„ ν™μ©ν•΄ λ€μƒμ„ μ§€μ •ν•  μ μλ‹¤.  

#### - AOPμ ν¬μΈνΈ μ»·  

- @Before: λ€μƒ λ©”μ†λ“μ μν–‰ μ „
- @After: λ€μƒ λ©”μ†λ“μ μν–‰ ν›„
- @AfterReturning: λ€μƒ λ©”μ†λ“μ μ •μƒμ μΈ μ‹¤ν–‰ ν›„
- @AfterThrwoing: λ€μƒ λ©”μ†λ“μ μμ™Έλ°μƒ ν›„
- @Around: λ€μƒ λ©”μ†λ“μ μν–‰ μ „ν›„

---

#### π“ Response  

- <https://goddaehee.tistory.com/154>
- <https://mangkyu.tistory.com/173>
- <https://baek-kim-dev.site/61>